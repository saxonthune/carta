{
  "version": 3,
  "title": "Carta Test Scenarios",
  "description": "Example scenarios demonstrating various Carta features and construct types.",
  "nodes": [
    {
      "id": "1",
      "type": "construct",
      "position": { "x": -600, "y": 100 },
      "data": {
        "constructType": "requirement",
        "semanticId": "requirement-clear-document",
        "values": {
          "title": "Clear Document",
          "description": "Users can clear the document to start fresh",
          "acceptanceCriteria": "- Nodes removed\n- Edges removed\n- Schemas preserved (instances mode)\n- Title preserved"
        },
        "isExpanded": true
      }
    },
    {
      "id": "2",
      "type": "construct",
      "position": { "x": -200, "y": 50 },
      "data": {
        "constructType": "test-scenario",
        "semanticId": "test-clear-everything",
        "values": {
          "name": "Clear Everything removes all document content",
          "priority": "smoke",
          "tags": "menu, destructive, document"
        },
        "isExpanded": true,
        "connections": [
          {
            "portId": "validates",
            "targetSemanticId": "requirement-clear-document",
            "targetPortId": "tested-by"
          },
          {
            "portId": "requires",
            "targetSemanticId": "fixture-document-with-content",
            "targetPortId": "provides"
          },
          {
            "portId": "first-step",
            "targetSemanticId": "step-open-menu",
            "targetPortId": "flow-in"
          }
        ]
      }
    },
    {
      "id": "3",
      "type": "construct",
      "position": { "x": -600, "y": 300 },
      "data": {
        "constructType": "fixture",
        "semanticId": "fixture-document-with-content",
        "values": {
          "name": "Document with content",
          "setup": "Load SaaS.carta example file",
          "teardown": "None required"
        },
        "isExpanded": true
      }
    },
    {
      "id": "4",
      "type": "construct",
      "position": { "x": 200, "y": 50 },
      "data": {
        "constructType": "test-step",
        "semanticId": "step-open-menu",
        "values": {
          "action": "Click hamburger menu",
          "selector": "[data-testid=\"menu-button\"]",
          "actionType": "click"
        },
        "isExpanded": true,
        "connections": [
          {
            "portId": "flow-out",
            "targetSemanticId": "step-click-clear",
            "targetPortId": "flow-in"
          }
        ]
      }
    },
    {
      "id": "5",
      "type": "construct",
      "position": { "x": 500, "y": 50 },
      "data": {
        "constructType": "test-step",
        "semanticId": "step-click-clear",
        "values": {
          "action": "Click Clear option",
          "selector": "text=Clear",
          "actionType": "click"
        },
        "isExpanded": true,
        "connections": [
          {
            "portId": "flow-out",
            "targetSemanticId": "step-confirm-clear-everything",
            "targetPortId": "flow-in"
          }
        ]
      }
    },
    {
      "id": "6",
      "type": "construct",
      "position": { "x": 800, "y": 50 },
      "data": {
        "constructType": "test-step",
        "semanticId": "step-confirm-clear-everything",
        "values": {
          "action": "Click 'Clear Everything' in modal",
          "selector": "text=Clear Everything",
          "actionType": "click"
        },
        "isExpanded": true,
        "connections": [
          {
            "portId": "flow-out",
            "targetSemanticId": "assertion-nodes-cleared",
            "targetPortId": "flow-in"
          }
        ]
      }
    },
    {
      "id": "7",
      "type": "construct",
      "position": { "x": 1100, "y": 50 },
      "data": {
        "constructType": "assertion",
        "semanticId": "assertion-nodes-cleared",
        "values": {
          "description": "No nodes exist on canvas",
          "type": "count",
          "selector": "[data-testid^=\"node-\"]",
          "expected": "0",
          "comparator": "equals"
        },
        "isExpanded": true,
        "connections": [
          {
            "portId": "flow-out",
            "targetSemanticId": "assertion-title-preserved",
            "targetPortId": "flow-in"
          }
        ]
      }
    },
    {
      "id": "8",
      "type": "construct",
      "position": { "x": 1400, "y": 50 },
      "data": {
        "constructType": "assertion",
        "semanticId": "assertion-title-preserved",
        "values": {
          "description": "Document title is preserved",
          "type": "text",
          "selector": "[data-testid=\"document-title\"]",
          "expected": "Friendship.AI",
          "comparator": "equals"
        },
        "isExpanded": true
      }
    },
    {
      "id": "9",
      "type": "construct",
      "position": { "x": -200, "y": 250 },
      "data": {
        "constructType": "test-scenario",
        "semanticId": "test-clear-instances-only",
        "values": {
          "name": "Clear Instances preserves schemas and deployables",
          "priority": "regression",
          "tags": "menu, document, schemas"
        },
        "isExpanded": true,
        "connections": [
          {
            "portId": "validates",
            "targetSemanticId": "requirement-clear-document",
            "targetPortId": "tested-by"
          },
          {
            "portId": "requires",
            "targetSemanticId": "fixture-document-with-content",
            "targetPortId": "provides"
          }
        ]
      }
    }
  ],
  "edges": [
    {
      "id": "e1",
      "source": "2",
      "target": "1",
      "sourceHandle": "validates",
      "targetHandle": "tested-by"
    },
    {
      "id": "e2",
      "source": "2",
      "target": "3",
      "sourceHandle": "requires",
      "targetHandle": "provides"
    },
    {
      "id": "e3",
      "source": "2",
      "target": "4",
      "sourceHandle": "first-step",
      "targetHandle": "flow-in"
    },
    {
      "id": "e4",
      "source": "4",
      "target": "5",
      "sourceHandle": "flow-out",
      "targetHandle": "flow-in"
    },
    {
      "id": "e5",
      "source": "5",
      "target": "6",
      "sourceHandle": "flow-out",
      "targetHandle": "flow-in"
    },
    {
      "id": "e6",
      "source": "6",
      "target": "7",
      "sourceHandle": "flow-out",
      "targetHandle": "flow-in"
    },
    {
      "id": "e7",
      "source": "7",
      "target": "8",
      "sourceHandle": "flow-out",
      "targetHandle": "flow-in"
    },
    {
      "id": "e8",
      "source": "9",
      "target": "1",
      "sourceHandle": "validates",
      "targetHandle": "tested-by"
    },
    {
      "id": "e9",
      "source": "9",
      "target": "3",
      "sourceHandle": "requires",
      "targetHandle": "provides"
    }
  ],
  "deployables": [],
  "schemas": [
    {
      "type": "requirement",
      "displayName": "Requirement",
      "color": "#10b981",
      "description": "A product requirement or acceptance criteria",
      "fields": [
        {
          "name": "title",
          "label": "Title",
          "type": "string"
        },
        {
          "name": "description",
          "label": "Description",
          "type": "string"
        },
        {
          "name": "acceptanceCriteria",
          "label": "Acceptance Criteria",
          "type": "string",
          "displayHint": "code"
        }
      ],
      "ports": [
        {
          "id": "tested-by",
          "portType": "flow-in",
          "position": "right",
          "offset": 50,
          "label": "Tested By",
          "description": "Test scenarios that validate this requirement"
        },
        {
          "id": "depends-on",
          "portType": "flow-out",
          "position": "left",
          "offset": 50,
          "label": "Depends On",
          "description": "Prerequisites for this requirement"
        }
      ]
    },
    {
      "type": "test-scenario",
      "displayName": "Test Scenario",
      "color": "#3b82f6",
      "description": "An end-to-end test scenario",
      "fields": [
        {
          "name": "name",
          "label": "Name",
          "type": "string"
        },
        {
          "name": "priority",
          "label": "Priority",
          "type": "enum",
          "options": ["smoke", "regression", "edge-case"],
          "default": "regression",
          "displayInMap": true
        },
        {
          "name": "tags",
          "label": "Tags",
          "type": "string",
          "placeholder": "comma-separated tags"
        }
      ],
      "ports": [
        {
          "id": "requires",
          "portType": "flow-out",
          "position": "left",
          "offset": 30,
          "label": "Requires",
          "description": "Fixtures this test depends on"
        },
        {
          "id": "validates",
          "portType": "flow-out",
          "position": "left",
          "offset": 70,
          "label": "Validates",
          "description": "Requirements this test covers"
        },
        {
          "id": "first-step",
          "portType": "flow-out",
          "position": "right",
          "offset": 50,
          "label": "First Step",
          "description": "Entry point to the test flow"
        }
      ]
    },
    {
      "type": "test-step",
      "displayName": "Test Step",
      "color": "#6366f1",
      "description": "A single action in a test scenario",
      "fields": [
        {
          "name": "action",
          "label": "Action",
          "type": "string"
        },
        {
          "name": "selector",
          "label": "Selector",
          "type": "string",
          "placeholder": "[data-testid=\"...\"]"
        },
        {
          "name": "actionType",
          "label": "Type",
          "type": "enum",
          "options": ["click", "type", "drag", "keyboard", "wait", "hover"],
          "default": "click",
          "displayInMap": true
        },
        {
          "name": "value",
          "label": "Value",
          "type": "string",
          "placeholder": "Input value or key sequence"
        }
      ],
      "ports": [
        {
          "id": "flow-in",
          "portType": "flow-in",
          "position": "left",
          "offset": 50,
          "label": "From",
          "description": "Previous step"
        },
        {
          "id": "flow-out",
          "portType": "flow-out",
          "position": "right",
          "offset": 50,
          "label": "Then",
          "description": "Next step"
        },
        {
          "id": "on-failure",
          "portType": "flow-out",
          "position": "bottom",
          "offset": 50,
          "label": "On Failure",
          "description": "Alternative path on failure"
        }
      ]
    },
    {
      "type": "assertion",
      "displayName": "Assertion",
      "color": "#22c55e",
      "description": "A verification point in a test",
      "fields": [
        {
          "name": "description",
          "label": "Description",
          "type": "string"
        },
        {
          "name": "type",
          "label": "Type",
          "type": "enum",
          "options": ["visible", "hidden", "text", "count", "attribute", "state"],
          "default": "visible",
          "displayInMap": true
        },
        {
          "name": "selector",
          "label": "Selector",
          "type": "string"
        },
        {
          "name": "expected",
          "label": "Expected",
          "type": "string"
        },
        {
          "name": "comparator",
          "label": "Comparator",
          "type": "enum",
          "options": ["equals", "contains", "matches", "gt", "lt"],
          "default": "equals"
        }
      ],
      "ports": [
        {
          "id": "flow-in",
          "portType": "flow-in",
          "position": "left",
          "offset": 50,
          "label": "After",
          "description": "Step that precedes this assertion"
        },
        {
          "id": "flow-out",
          "portType": "flow-out",
          "position": "right",
          "offset": 50,
          "label": "Then",
          "description": "Continue to next step"
        }
      ]
    },
    {
      "type": "fixture",
      "displayName": "Fixture",
      "color": "#f59e0b",
      "description": "Test setup and teardown",
      "fields": [
        {
          "name": "name",
          "label": "Name",
          "type": "string"
        },
        {
          "name": "setup",
          "label": "Setup",
          "type": "string",
          "displayHint": "code"
        },
        {
          "name": "teardown",
          "label": "Teardown",
          "type": "string",
          "displayHint": "code"
        }
      ],
      "ports": [
        {
          "id": "provides",
          "portType": "flow-in",
          "position": "right",
          "offset": 50,
          "label": "Provides",
          "description": "Test scenarios that use this fixture"
        },
        {
          "id": "depends-on",
          "portType": "flow-out",
          "position": "left",
          "offset": 50,
          "label": "Depends On",
          "description": "Other fixtures required first"
        }
      ]
    }
  ],
  "portSchemas": [
    {
      "id": "flow-in",
      "displayName": "Flow In",
      "semanticDescription": "Receives data or control flow",
      "polarity": "sink",
      "compatibleWith": ["flow-out", "forward"],
      "expectedComplement": "flow-out",
      "defaultPosition": "left",
      "color": "#3b82f6"
    },
    {
      "id": "flow-out",
      "displayName": "Flow Out",
      "semanticDescription": "Sends data or control flow",
      "polarity": "source",
      "compatibleWith": ["flow-in", "intercept"],
      "expectedComplement": "flow-in",
      "defaultPosition": "right",
      "color": "#22c55e"
    }
  ]
}
